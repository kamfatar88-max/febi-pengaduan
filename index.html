INDEXHTML  <!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Layanan Pengaduan FEBI</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f8f9fa; }
    .tabs { display: flex; background: #003366; color: white; }
    .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; }
    .tab.active { background: #0055a5; }
    .content { display: none; padding: 20px; }
    .content.active { display: block; }
    form { margin-top: 20px; }
    input, textarea, select { width: 100%; padding: 8px; margin: 5px 0; }
    button { padding: 10px 20px; background: #0055a5; color: white; border: none; cursor: pointer; }
    button:hover { background: #0077cc; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    table, th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  </style>
</head>
<body>

<div class="tabs">
  <div class="tab active" onclick="showTab('aduan')">Input Aduan</div>
  <div class="tab" onclick="showTab('respon')">Input Respon</div>
  <div class="tab" onclick="showTab('data')">Data Aduan</div>
  <div class="tab" onclick="showTab('statistik')">Statistik</div>
</div>

<!-- Tab Input Aduan -->
<div id="aduan" class="content active">
  <h2>Form Pengaduan</h2>
  <form id="formAduan">
    <input type="text" name="nama" placeholder="Nama" required>
    <select name="jabatan" required>
      <option value="">-- Pilih Jabatan --</option>
      <option value="Mahasiswa">Mahasiswa</option>
      <option value="Tendik">Tendik</option>
      <option value="Dosen">Dosen</option>
    </select>
    <textarea name="isi" placeholder="Isi Aduan" required></textarea>
    <button type="submit">Kirim Aduan</button>
  </form>
</div>

<!-- Tab Input Respon -->
<div id="respon" class="content">
  <h2>Form Respon Aduan</h2>
  <form id="formRespon">
    <input type="text" name="identifikasi" placeholder="Identifikasi Masalah" required>
    <input type="text" name="sumber" placeholder="Sumber Masalah" required>
    <input type="text" name="rencana" placeholder="Rencana Aksi" required>
    <input type="text" name="waktu" placeholder="Waktu Penyelesaian" required>
    <input type="text" name="penanggungjawab" placeholder="Penanggungjawab" required>
    <button type="submit">Kirim Respon</button>
  </form>
</div>

<!-- Tab Data -->
<div id="data" class="content">
  <h2>Data Pengaduan</h2>
  <table id="tableData">
    <thead>
      <tr>
        <th>Nama</th>
        <th>Jabatan</th>
        <th>Isi Aduan</th>
        <th>Tanggal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Tab Statistik -->
<div id="statistik" class="content">
  <h2>Statistik Pengaduan</h2>
  <canvas id="chartAduan"></canvas>
</div>

<script>
const scriptURL = "PASTE_YOUR_GOOGLE_APPS_SCRIPT_URL_HERE";

// Tab navigasi
function showTab(tabId) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

// Kirim Aduan
document.getElementById('formAduan').addEventListener('submit', e => {
  e.preventDefault();
  const data = [
    e.target.nama.value,
    e.target.jabatan.value,
    e.target.isi.value,
    new Date().toLocaleString()
  ];
  fetch(scriptURL+"?sheet=Aduan", { method: 'POST', body: JSON.stringify(data) })
    .then(r => alert("Aduan berhasil dikirim"))
    .catch(err => alert("Error: " + err));
  e.target.reset();
});

// Kirim Respon
document.getElementById('formRespon').addEventListener('submit', e => {
  e.preventDefault();
  const data = [
    e.target.identifikasi.value,
    e.target.sumber.value,
    e.target.rencana.value,
    e.target.waktu.value,
    e.target.penanggungjawab.value,
    new Date().toLocaleString()
  ];
  fetch(scriptURL+"?sheet=Respon", { method: 'POST', body: JSON.stringify(data) })
    .then(r => alert("Respon berhasil dikirim"))
    .catch(err => alert("Error: " + err));
  e.target.reset();
});

// Load Data Aduan (real-time)
async function loadData() {
  let res = await fetch(scriptURL+"?sheet=Aduan");
  let data = await res.json();
  let tbody = document.querySelector("#tableData tbody");
  tbody.innerHTML = "";
  data.slice(1).forEach(row => {
    let tr = document.createElement("tr");
    tr.innerHTML = `<td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}</td>`;
    tbody.appendChild(tr);
  });
  updateChart(data);
}

// Update Statistik
function updateChart(data) {
  let counts = {Mahasiswa:0, Dosen:0, Tendik:0};
  data.slice(1).forEach(row => {
    if (row[1] in counts) counts[row[1]]++;
  });
  const ctx = document.getElementById('chartAduan').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Object.keys(counts),
      datasets: [{
        label: 'Jumlah Aduan',
        data: Object.values(counts),
        backgroundColor: ['#007bff','#28a745','#ffc107']
      }]
    }
  });
}

loadData(); // jalankan saat halaman dibuka
</script>
</body>
</html>
